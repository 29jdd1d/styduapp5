<!--pages/mine/mine.wxml-->
<view class="mine-page">
  <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
  <view class="user-card">
    <view class="user-bg"></view>
    <view class="user-content" wx:if="{{userInfo}}">
      <image class="user-avatar" src="{{userInfo.avatar || '/images/default-avatar.png'}}" mode="aspectFill"/>
      <view class="user-info">
        <text class="user-name">{{userInfo.nickname || 'è€ƒç ”å­¦å­'}}</text>
        <view class="user-major" wx:if="{{userInfo.majorName}}">
          <text class="major-icon">ğŸ“</text>
          <text class="major-name">{{userInfo.majorName}}</text>
        </view>
      </view>
      <view class="edit-btn" bindtap="goToProfile">
        <text>ç¼–è¾‘èµ„æ–™</text>
      </view>
    </view>
    <view class="user-content login-tip" wx:else bindtap="goToLogin">
      <image class="user-avatar" src="/images/default-avatar.png" mode="aspectFill"/>
      <text class="login-text">ç‚¹å‡»ç™»å½•</text>
    </view>
  </view>

  <!-- å­¦ä¹ æ•°æ® -->
  <view class="stats-card">
    <view class="stats-title">å­¦ä¹ æ•°æ®</view>
    <view class="stats-grid">
      <view class="stat-item" bindtap="goToRecords" data-type="study">
        <text class="stat-num">{{stats.studyDays || 0}}</text>
        <text class="stat-label">å­¦ä¹ å¤©æ•°</text>
      </view>
      <view class="stat-item" bindtap="goToRecords" data-type="practice">
        <text class="stat-num">{{stats.practiceCount || 0}}</text>
        <text class="stat-label">ç»ƒä¹ é¢˜æ•°</text>
      </view>
      <view class="stat-item" bindtap="goToRecords" data-type="checkin">
        <text class="stat-num">{{stats.checkinDays || 0}}</text>
        <text class="stat-label">æ‰“å¡å¤©æ•°</text>
      </view>
      <view class="stat-item" bindtap="goToRecords" data-type="video">
        <text class="stat-num">{{stats.videoHours || 0}}</text>
        <text class="stat-label">è§†é¢‘æ—¶é•¿(h)</text>
      </view>
    </view>
  </view>

  <!-- åŠŸèƒ½èœå• -->
  <view class="menu-card">
    <view class="menu-item" bindtap="goToPage" data-url="/pages/question/wrong/wrong">
      <view class="menu-icon">ğŸ“•</view>
      <text class="menu-text">æˆ‘çš„é”™é¢˜</text>
      <text class="menu-badge" wx:if="{{wrongCount > 0}}">{{wrongCount}}</text>
      <text class="menu-arrow">></text>
    </view>
    <view class="menu-item" bindtap="goToPage" data-url="/pages/question/favorite/favorite">
      <view class="menu-icon">â­</view>
      <text class="menu-text">æˆ‘çš„æ”¶è—</text>
      <text class="menu-badge" wx:if="{{favoriteCount > 0}}">{{favoriteCount}}</text>
      <text class="menu-arrow">></text>
    </view>
    <view class="menu-item" bindtap="goToRecords" data-type="course">
      <view class="menu-icon">ğŸ“š</view>
      <text class="menu-text">å­¦ä¹ è®°å½•</text>
      <text class="menu-arrow">></text>
    </view>
    <view class="menu-item" bindtap="goToRecords" data-type="exam">
      <view class="menu-icon">ğŸ“</view>
      <text class="menu-text">è€ƒè¯•è®°å½•</text>
      <text class="menu-arrow">></text>
    </view>
  </view>

  <view class="menu-card">
    <view class="menu-item" bindtap="goToPage" data-url="/pages/checkin/ranking/ranking">
      <view class="menu-icon">ğŸ†</view>
      <text class="menu-text">æ‰“å¡æ’è¡Œ</text>
      <text class="menu-arrow">></text>
    </view>
    <view class="menu-item" bindtap="changeMajor">
      <view class="menu-icon">ğŸ¯</view>
      <text class="menu-text">åˆ‡æ¢ä¸“ä¸š</text>
      <text class="menu-sub">{{userInfo.majorName || 'æœªé€‰æ‹©'}}</text>
      <text class="menu-arrow">></text>
    </view>
    <view class="menu-item" bindtap="clearCache">
      <view class="menu-icon">ğŸ§¹</view>
      <text class="menu-text">æ¸…é™¤ç¼“å­˜</text>
      <text class="menu-sub">{{cacheSize}}</text>
      <text class="menu-arrow">></text>
    </view>
    <view class="menu-item" bindtap="showAbout">
      <view class="menu-icon">â„¹ï¸</view>
      <text class="menu-text">å…³äºæˆ‘ä»¬</text>
      <text class="menu-arrow">></text>
    </view>
  </view>

  <!-- é€€å‡ºç™»å½• -->
  <view class="logout-btn" wx:if="{{userInfo}}" bindtap="logout">
    é€€å‡ºç™»å½•
  </view>
</view>
