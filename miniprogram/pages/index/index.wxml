<!--pages/index/index.wxml-->
<view class="index-page">
  <!-- é¡¶éƒ¨ç”¨æˆ·ä¿¡æ¯åŒºåŸŸ -->
  <view class="header-section">
    <view class="user-info" bindtap="goToProfile">
      <image class="avatar" src="{{userInfo.avatar || '/images/default-avatar.png'}}" mode="aspectFill"/>
      <view class="info">
        <text class="nickname">{{userInfo.nickname || 'æœªç™»å½•'}}</text>
        <text class="major">{{userInfo.majorName || 'è¯·é€‰æ‹©ä¸“ä¸š'}}</text>
      </view>
    </view>
    
    <!-- è€ƒç ”å€’è®¡æ—¶ -->
    <view class="countdown-box" wx:if="{{countdown}}">
      <text class="countdown-label">è·ç¦»{{examYear}}è€ƒç ”</text>
      <view class="countdown-num">
        <text class="num">{{countdown.days}}</text>
        <text class="unit">å¤©</text>
      </view>
    </view>
  </view>

  <!-- å­¦ä¹ ç»Ÿè®¡ -->
  <view class="stats-card card">
    <view class="stats-item">
      <text class="stats-num">{{userInfo.studyDays || 0}}</text>
      <text class="stats-label">å­¦ä¹ å¤©æ•°</text>
    </view>
    <view class="stats-divider"></view>
    <view class="stats-item">
      <text class="stats-num">{{userInfo.totalQuestions || 0}}</text>
      <text class="stats-label">åšé¢˜æ•°é‡</text>
    </view>
    <view class="stats-divider"></view>
    <view class="stats-item">
      <text class="stats-num">{{checkinStats.streakDays || 0}}</text>
      <text class="stats-label">è¿ç»­æ‰“å¡</text>
    </view>
  </view>

  <!-- ä»Šæ—¥æ‰“å¡ -->
  <view class="checkin-card card" bindtap="goToCheckin">
    <view class="checkin-left">
      <image class="checkin-icon" src="/images/checkin-icon.png" mode="aspectFit"/>
      <view class="checkin-info">
        <text class="checkin-title">{{todayCheckin ? 'ä»Šæ—¥å·²æ‰“å¡' : 'ä»Šæ—¥æœªæ‰“å¡'}}</text>
        <text class="checkin-desc">{{todayCheckin ? 'ç»§ç»­ä¿æŒï¼ŒåŠ æ²¹ï¼' : 'åšæŒæ‰“å¡ï¼Œå…»æˆä¹ æƒ¯'}}</text>
      </view>
    </view>
    <view class="checkin-btn {{todayCheckin ? 'done' : ''}}">
      {{todayCheckin ? 'å·²å®Œæˆ' : 'å»æ‰“å¡'}}
    </view>
  </view>

  <!-- å¿«æ·å…¥å£ -->
  <view class="quick-entry card">
    <view class="entry-item" bindtap="goToPage" data-url="/pages/course/list/list">
      <view class="entry-icon-wrap bg-blue">
        <image class="entry-icon" src="/images/icon-course.png" mode="aspectFit"/>
      </view>
      <text class="entry-text">è§†é¢‘è¯¾ç¨‹</text>
    </view>
    <view class="entry-item" bindtap="goToPage" data-url="/pages/question/category/category">
      <view class="entry-icon-wrap bg-green">
        <image class="entry-icon" src="/images/icon-question.png" mode="aspectFit"/>
      </view>
      <text class="entry-text">åˆ·é¢˜ç»ƒä¹ </text>
    </view>
    <view class="entry-item" bindtap="goToPage" data-url="/pages/exam/list/list">
      <view class="entry-icon-wrap bg-orange">
        <image class="entry-icon" src="/images/icon-exam.png" mode="aspectFit"/>
      </view>
      <text class="entry-text">æ¨¡æ‹Ÿè€ƒè¯•</text>
    </view>
    <view class="entry-item" bindtap="goToPage" data-url="/pages/question/wrong/wrong">
      <view class="entry-icon-wrap bg-red">
        <image class="entry-icon" src="/images/icon-wrong.png" mode="aspectFit"/>
      </view>
      <text class="entry-text">é”™é¢˜æœ¬</text>
    </view>
  </view>

  <!-- æ¨èè¯¾ç¨‹ -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">æ¨èè¯¾ç¨‹</text>
      <text class="section-more" bindtap="goToPage" data-url="/pages/course/list/list">æŸ¥çœ‹æ›´å¤š â€º</text>
    </view>
    
    <scroll-view class="course-scroll" scroll-x enhanced show-scrollbar="{{false}}">
      <view class="course-list">
        <view 
          class="course-item" 
          wx:for="{{recommendCourses}}" 
          wx:key="id"
          bindtap="goToCourseDetail"
          data-id="{{item.id}}"
        >
          <image class="course-cover" src="{{item.cover || '/images/default-cover.png'}}" mode="aspectFill"/>
          <view class="course-info">
            <text class="course-title text-ellipsis">{{item.title}}</text>
            <text class="course-teacher">{{item.teacherName}}</text>
            <view class="course-meta">
              <text class="course-count">{{item.chapterCount}}ç« èŠ‚</text>
              <text class="course-views">{{item.viewCount}}äººå­¦ä¹ </text>
            </view>
          </view>
        </view>
        
        <view class="course-item empty-placeholder" wx:if="{{recommendCourses.length === 0}}">
          <text class="placeholder-text">æš‚æ— æ¨èè¯¾ç¨‹</text>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- çƒ­é—¨å¸–å­ -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">çƒ­é—¨è®¨è®º</text>
      <text class="section-more" bindtap="goToPage" data-url="/pages/community/list/list">æŸ¥çœ‹æ›´å¤š â€º</text>
    </view>
    
    <view class="post-list">
      <view 
        class="post-item card"
        wx:for="{{hotPosts}}"
        wx:key="id"
        bindtap="goToPostDetail"
        data-id="{{item.id}}"
      >
        <view class="post-header">
          <image class="post-avatar" src="{{item.userAvatar || '/images/default-avatar.png'}}" mode="aspectFill"/>
          <view class="post-user">
            <text class="post-nickname">{{item.userNickname}}</text>
            <text class="post-time">{{item.createTimeStr}}</text>
          </view>
          <view class="post-type-tag">{{item.typeText}}</view>
        </view>
        <text class="post-title">{{item.title}}</text>
        <text class="post-content text-ellipsis-2">{{item.content}}</text>
        <view class="post-footer">
          <view class="post-stat">
            <text class="iconfont">ğŸ‘</text>
            <text>{{item.viewCount}}</text>
          </view>
          <view class="post-stat">
            <text class="iconfont">ğŸ‘</text>
            <text>{{item.likeCount}}</text>
          </view>
          <view class="post-stat">
            <text class="iconfont">ğŸ’¬</text>
            <text>{{item.commentCount}}</text>
          </view>
        </view>
      </view>
      
      <view class="empty" wx:if="{{hotPosts.length === 0}}">
        <text class="empty-text">æš‚æ— çƒ­é—¨å¸–å­</text>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨é—´è· -->
  <view style="height: 30rpx;"></view>
</view>
