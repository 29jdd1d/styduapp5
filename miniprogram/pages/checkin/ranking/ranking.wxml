<!--pages/checkin/ranking/ranking.wxml-->
<view class="ranking-page">
  <!-- Tabåˆ‡æ¢ -->
  <view class="tab-bar">
    <view 
      class="tab-item {{activeTab === 'streak' ? 'active' : ''}}"
      bindtap="switchTab"
      data-tab="streak"
    >è¿ç»­æ‰“å¡æ¦œ</view>
    <view 
      class="tab-item {{activeTab === 'total' ? 'active' : ''}}"
      bindtap="switchTab"
      data-tab="total"
    >ç´¯è®¡æ‰“å¡æ¦œ</view>
  </view>

  <!-- æˆ‘çš„æ’å -->
  <view class="my-ranking card" wx:if="{{myRanking}}">
    <view class="my-rank-num">{{myRanking.rank || '--'}}</view>
    <image class="my-avatar" src="{{myRanking.avatar || '/images/default-avatar.png'}}" mode="aspectFill"/>
    <view class="my-info">
      <text class="my-nickname">{{myRanking.nickname}}</text>
      <text class="my-days">{{activeTab === 'streak' ? myRanking.streakDays : myRanking.totalDays}}å¤©</text>
    </view>
    <text class="my-label">æˆ‘çš„æ’å</text>
  </view>

  <!-- æ’è¡Œæ¦œåˆ—è¡¨ -->
  <scroll-view 
    class="ranking-list" 
    scroll-y 
    enhanced 
    show-scrollbar="{{false}}"
  >
    <view 
      class="ranking-item {{index < 3 ? 'top-' + (index + 1) : ''}}"
      wx:for="{{rankingList}}"
      wx:key="userId"
    >
      <view class="rank-num">
        <text wx:if="{{index >= 3}}">{{index + 1}}</text>
        <text wx:elif="{{index === 0}}" class="medal">ğŸ¥‡</text>
        <text wx:elif="{{index === 1}}" class="medal">ğŸ¥ˆ</text>
        <text wx:elif="{{index === 2}}" class="medal">ğŸ¥‰</text>
      </view>
      <image class="user-avatar" src="{{item.avatar || '/images/default-avatar.png'}}" mode="aspectFill"/>
      <view class="user-info">
        <text class="user-nickname">{{item.nickname}}</text>
        <text class="user-major" wx:if="{{item.majorName}}">{{item.majorName}}</text>
      </view>
      <view class="rank-days">
        <text class="days-num">{{activeTab === 'streak' ? item.streakDays : item.totalDays}}</text>
        <text class="days-unit">å¤©</text>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty" wx:if="{{!loading && rankingList.length === 0}}">
      <text class="empty-text">æš‚æ— æ’è¡Œæ•°æ®</text>
    </view>
  </scroll-view>
</view>
